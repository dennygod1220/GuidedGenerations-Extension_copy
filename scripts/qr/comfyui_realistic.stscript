// ComfyUI çœŸå¯¦äººç‰©é¢¨æ ¼ç”Ÿåœ–è…³æœ¬
// é©ç”¨æ–¼çœŸå¯¦äººç‰©è§’è‰²å¡,ä¿æŒè§’è‰²å¤–è§€

// å®šç¾©æç¤ºè©å‰ç¶´
/let prefix [You are an assistant enhancing the prompt.\nAdd another person to this image. The person in the original image is {{char}}, keep their appearance exactly the same. Add {{user}} as a new person in the scene.\n\nVisual Requirements:\n- Only {{user}} and {{char}} appear in the image, no other people\n- No text or watermarks in the image\n- Realistic skin tones for East Asian characters, no unnatural colors\n\nAnatomical Requirements:\n- Correct human anatomy: each person has exactly 2 arms, 2 legs, 1 head\n- Natural human poses only, no impossible or contorted positions\n- Correct gender characteristics: males have male anatomy, females have female anatomy\n- No extra limbs, no missing body parts\n- Proper body proportions and joint positions\n\nCharacter Race: East Asian\n] |

// ç²å–ç•¶å‰ custom_auto_guide è®Šæ•¸å…§å®¹
/getvar key=custom_auto_guide |
/let current_prompt {{pipe}} |

// æª¢æŸ¥æ˜¯å¦ç‚ºç©º,å¦‚æœç‚ºç©ºå‰‡å…ˆç”Ÿæˆ
/if left={{var::current_prompt}} rule=empty else=":generate_image" |
    /echo ğŸ”„ Custom Auto Guide è®Šæ•¸ç‚ºç©ºï¼Œæ­£åœ¨ç”Ÿæˆ... |
    /run-persistent-guide customAuto |
    /delay 1000 |
    /getvar key=custom_auto_guide |
    /let current_prompt {{pipe}} |
:generate_image |

// æª¢æŸ¥æ˜¯å¦æˆåŠŸç²å–
/if left={{var::current_prompt}} rule=empty else=":call_comfyui" |
    /echo âŒ ç„¡æ³•ç”Ÿæˆ Custom Auto Guideï¼Œè«‹æª¢æŸ¥è¨­å®š |
    /abort |
:call_comfyui |

// çµ„åˆå®Œæ•´ prompt: å‰ç¶´ + Custom Auto Guide å…§å®¹
/let final_prompt {{var::prefix}}\n\n{{var::current_prompt}} |

// å‘¼å« ComfyUI
/echo ğŸ¨ æ­£åœ¨ä½¿ç”¨çœŸå¯¦äººç‰©é¢¨æ ¼å‘¼å« ComfyUI... |
/sd extend=false {{var::final_prompt}} |
/echo âœ… ComfyUI è«‹æ±‚å·²ç™¼é€ï¼(çœŸå¯¦äººç‰©é¢¨æ ¼) |
