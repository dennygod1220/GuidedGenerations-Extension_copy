// ComfyUI å¡é€šå‹•æ¼«é¢¨æ ¼ç”Ÿåœ–è…³æœ¬
// é©ç”¨æ–¼å¡é€š/å‹•æ¼«è§’è‰²å¡,åƒç…§å¡é€šé¢¨æ ¼

// å®šç¾©æç¤ºè©å‰ç¶´
/let prefix [You are an assistant enhancing the prompt.\nAdd another person to this image. The person in the original image is {{char}}, maintain their cartoon/anime style and key features. Add {{user}} as a new person in the same artistic style.\n\nVisual Requirements:\n- Only {{user}} and {{char}} appear in the image, no other people\n- No text or watermarks in the image\n- Maintain consistent anime/cartoon art style throughout\n- Keep the original character design and color palette\n- Match the artistic style of the reference image (anime, cartoon, illustration, etc.)\n\nAnatomical Requirements:\n- Stylized anatomy appropriate for the art style\n- Each person has exactly 2 arms, 2 legs, 1 head\n- Poses should fit the art style (can be more dynamic/expressive than realistic)\n- Correct gender characteristics for the art style\n- No extra limbs, no missing body parts\n- Proportions should match the reference art style\n\nCharacter Race: East Asian\n] |

// ç²å–ç•¶å‰ custom_auto_guide è®Šæ•¸å…§å®¹
/getvar key=custom_auto_guide |
/let current_prompt {{pipe}} |

// æª¢æŸ¥æ˜¯å¦ç‚ºç©º,å¦‚æœç‚ºç©ºå‰‡å…ˆç”Ÿæˆ
/if left={{var::current_prompt}} rule=empty else=":generate_image" |
    /echo ğŸ”„ Custom Auto Guide è®Šæ•¸ç‚ºç©ºï¼Œæ­£åœ¨ç”Ÿæˆ... |
    /run-persistent-guide customAuto |
    /delay 1000 |
    /getvar key=custom_auto_guide |
    /let current_prompt {{pipe}} |
:generate_image |

// æª¢æŸ¥æ˜¯å¦æˆåŠŸç²å–
/if left={{var::current_prompt}} rule=empty else=":call_comfyui" |
    /echo âŒ ç„¡æ³•ç”Ÿæˆ Custom Auto Guideï¼Œè«‹æª¢æŸ¥è¨­å®š |
    /abort |
:call_comfyui |

// çµ„åˆå®Œæ•´ prompt: å‰ç¶´ + Custom Auto Guide å…§å®¹
/let final_prompt {{var::prefix}}\n\n{{var::current_prompt}} |

// å‘¼å« ComfyUI
/echo ğŸ¨ æ­£åœ¨ä½¿ç”¨å¡é€šå‹•æ¼«é¢¨æ ¼å‘¼å« ComfyUI... |
/sd extend=false {{var::final_prompt}} |
/echo âœ… ComfyUI è«‹æ±‚å·²ç™¼é€ï¼(å¡é€šå‹•æ¼«é¢¨æ ¼) |
